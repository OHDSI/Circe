<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" href="js/jqueryui/themes/base/jquery-ui.css" />
	<link rel="stylesheet" href="css/bootstrap.min.css" />
	<link rel="stylesheet" href="css/bootstrap-theme.min.css" />
	<link rel="stylesheet" href="css/circe.boostrap.css" />
	
	<script src="js/require.js"></script>
	<script src="js/main.js"></script>
</head>

<body>
	<div id="wrapper" style="display:none" data-bind="visible: selectedView() != null">
		<div data-bind="visible: selectedView() == 'list'">
			<button data-bind="click: newDefinition">New Definition</button>
			<table class="stripe compact hover" cellspacing="0" width="100%" 
				data-bind="dataTable:{
					onRowClick: selectDefinition,
					data: definitions(),
					options: {
						deferRender: true,
						orderClasses: false,
						autoWidth: true,
						order: [ 1, 'asc' ],
						columns: [
							{ data: 'id', title: 'Id' },
							{ data: 'name', title: 'Title' },
							{ data: 'expressionType', title: 'Definition Type' },
							{ data: 'description', title: 'Description'}
						],
						language: {
							search: 'Filter records:'
						}
					}
				 }">
			</table>
		</div>
		<div data-bind="visible: selectedView() == 'detail'">
		<table width="70%">
			<col width="100%" />
			<tr>
				<td style="vertical-align: top">
					<div data-bind="if: selectedDefinition()">
						Title:
						<input data-bind="value: selectedDefinition().name"></input>
						<button data-bind="click: saveAndClose">Save and Close</button>
						<button data-bind="click: cancel">Cancel</button>
						<cohort-expression-editor params="expression: selectedDefinition().expression"></cohort-expression-editor>
						<button data-bind="click: generate">Show SQL</button>
						<!-- ko if: generateOptions() != null -->
						<table>
							<tr>
								<td>CDM Schema:</td>
								<td><input data-bind="value: generateOptions().cdmSchema"></input></td>
							</tr>
							<tr>
								<td>Target Schema:</td>
								<td><input data-bind="value: generateOptions().targetSchema"></input></td>
							</tr>
							<tr>
								<td>Target Table:</td>
								<td><input data-bind="value: generateOptions().targetTable"></input></td>
							</tr>
							<tr>
								<td>Cohort Def Id:</td>
								<td><input data-bind="value: generateOptions().cohortId"></input></td>
							</tr>
						</table>
						<button data-bind="click: removeGenerateOptions">Remove Options</button>
						<!-- /ko -->
						<!-- ko if: generateOptions() == null -->
						<button data-bind="click: addGenerateOptions">Add Options</button>
						<!-- /ko -->
					
					</div>
				</td>
			</tr>
		</table>
	 	<!-- ko if: isGeneratedOpen -->
		<div title="Generated Sql..." data-bind="dialog: { isOpen: isGeneratedOpen, modal: true, width:700, height:500 }">
			<div class="tabs" data-bind="tabs: { }">
				<ul>
					<li data-bind="attr: { 'aria-controls': 'sql_server' }">
						<a data-bind="attr: { title: 'MSSQL Server', href: '#sql_server' }, text: 'MSSQL Server'"></a>
					</li>
					<li data-bind="attr: { 'aria-controls': 'oracle' }">
						<a data-bind="attr: { title: 'Oracle', href: '#oracle' }, text: 'Oracle'"></a>
					</li>
					<li data-bind="attr: { 'aria-controls': 'postgres' }">
						<a data-bind="attr: { title: 'Postgres', href: '#postgres' }, text: 'Postgres'"></a>
					</li>
					<li data-bind="attr: { 'aria-controls': 'redshift' }">
						<a data-bind="attr: { title: 'Red Shift', href: '#redshift' }, text: 'Red Shift'"></a>
					</li>
				</ul>
				<div data-bind="attr: { id: 'sql_server' }">
					<pre data-bind="text: generatedSql.mssql"></pre>
				</div>
				<div data-bind="attr: { id: 'oracle' }">
					<pre data-bind="text: generatedSql.oracle"></pre>
				</div>
				<div data-bind="attr: { id: 'postgres' }">
					<pre data-bind="text: generatedSql.postgres"></pre>
				</div>
				<div data-bind="attr: { id: 'redshift' }">
					<pre data-bind="text: generatedSql.redshift"></pre>
				</div>
			</div>
		</div>
		<!-- /ko -->
		</div>
	</div>
</body>

</html>
